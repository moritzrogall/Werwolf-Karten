<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Werwolf Karten</title>

<!-- PWA Meta Tags fÃ¼r iPhone -->
<link
  rel="apple-touch-icon"
  href="data:image/svg+xml;base64,CjxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMjAwIDIwMCc+CiAgPHJlY3Qgd2lkdGg9JzIwMCcgaGVpZ2h0PScyMDAnIHJ4PSc0MCcgZmlsbD0nIzFhMTUyYScvPgogIDx0ZXh0IHg9JzUwJScgeT0nNTUlJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBmb250LXNpemU9JzEyMCcgZHk9Jy4zZW0nPvCfkLo8L3RleHQ+Cjwvc3ZnPgo=" />
<link
  rel="manifest"
  href="data:application/manifest+json;base64,eyJuYW1lIjogIldlcndvbGYgS2FydGVuIiwgInNob3J0X25hbWUiOiAiV2Vyd29sZiIsICJzdGFydF91cmwiOiAiLiIsICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLCAiYmFja2dyb3VuZF9jb2xvciI6ICIjMGIwYjEyIiwgInRoZW1lX2NvbG9yIjogIiMwYjBiMTIiLCAiaWNvbnMiOiBbeyJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxDanh6ZG1jZ2VHMXNibk05SjJoMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSnlCMmFXVjNRbTk0UFNjd0lEQWdNakF3SURJd01DYytDaUFnUEhKbFkzUWdkMmxrZEdnOUp6SXdNQ2NnYUdWcFoyaDBQU2N5TURBbklISjRQU2MwTUNjZ1ptbHNiRDBuSXpGaE1UVXlZU2N2UGdvZ0lEeDBaWGgwSUhnOUp6VXdKU2NnZVQwbk5UVWxKeUIwWlhoMExXRnVZMmh2Y2owbmJXbGtaR3hsSnlCbWIyNTBMWE5wZW1VOUp6RXlNQ2NnWkhrOUp5NHpaVzBuUHZDZmtMbzhMM1JsZUhRK0Nqd3ZjM1puUGdvPSIsICJzaXplcyI6ICIxOTJ4MTkyIiwgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCJ9XX0=" />

<style>
:root {
  --bg: #06050a;
  --panel: #0f0d14;
  --muted: #9aa0a6;
  --accent: #8b5cf6;
  --accent-2: #6d28d9;
  --glass: rgba(255, 255, 255, 0.04);
  --card-w: 220px;
  --card-h: 320px;
}
* { box-sizing: border-box; }
html, body { height: 100%; margin:0; padding:14px; display:flex; align-items:center; justify-content:center; background: radial-gradient(800px 400px at 20% 10%, rgba(139,92,246,0.09), transparent), var(--bg); color:#edf0f6; font-family:-apple-system, BlinkMacSystemFont, "Inter", sans-serif; -webkit-font-smoothing: antialiased; }
.app { width:100%; max-width:440px; }
header { display:flex; gap:12px; align-items:center; margin-bottom:10px; }
.logo { width:46px; height:46px; border-radius:12px; background: linear-gradient(135deg,var(--accent),var(--accent-2)); display:flex; align-items:center; justify-content:center; font-weight:700; box-shadow:0 8px 30px rgba(109,40,217,0.18);}
h1 { font-size:18px; margin:0;}
p.lead { margin:0; color:var(--muted); font-size:13px;}
.card { background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent); border-radius:14px; padding:14px; box-shadow:0 6px 24px rgba(0,0,0,0.6);}
.section { margin-bottom:12px; }
.row { display:flex; gap:8px; align-items:center;}
.btn { display:inline-block; padding:12px; border-radius:12px; border:none; background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; font-weight:700; font-size:16px; width:100%; }
.btn-ghost { background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:10px; border-radius:10px; width:100%; }
.small { font-size:13px; color:var(--muted); }
input[type="text"] { width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit; font-size:16px; }

.roles-list { display:flex; flex-direction:column; gap:8px; margin-top:8px; max-height:500px; overflow-y:auto; scroll-behavior:smooth; padding-right:4px; }
.role-row { display:flex; align-items:center; gap:8px; padding:8px; border-radius:10px; background: rgba(255,255,255,0.02);}
.role-icon { width:44px; height:44px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);}
.role-name { flex:1; font-weight:600; }
.role-controls { display:flex; align-items:center; gap:8px; }
.count-btn { background: rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.12); border-radius:8px; width:36px; height:36px; color:white; font-size:18px; font-weight:700; }

.players-grid { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
.player-input { display:flex; gap:8px; align-items:center; }
.player-input input { flex:1; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit; font-size:16px; }

.game-area { display:flex; flex-direction:column; align-items:center; gap:12px; padding-top:6px; }
.deck { width:var(--card-w); height:var(--card-h); perspective:1100px; margin-top:4px; }
.card-inner { width:100%; height:100%; position:relative; transform-style:preserve-3d; transition: transform 0.65s cubic-bezier(0.2,0.9,0.3,1);}
.flipped .card-inner { transform:rotateY(180deg);}
.face { position:absolute; inset:0; border-radius:12px; backface-visibility:hidden; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:14px; border:1px solid rgba(255,255,255,0.03);}
.face.front { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); }
.face.back { transform:rotateY(180deg); background:linear-gradient(180deg, rgba(109,40,217,0.16), rgba(139,92,246,0.06)); }
.player-name { font-size:18px; font-weight:700; text-align:center; }
.role-emoji { font-size:46px; margin-bottom:6px; }
.role-label { font-size:18px; font-weight:700; }

.controls { display:flex; flex-direction:column; gap:8px; width:100%; }
.controls .row { display:flex; gap:8px; }
.controls .row .btn, .controls .row .btn-ghost { flex:1; }

.shuffle-anim { animation: shuffle 1.05s ease-in-out; }
@keyframes shuffle { 0%{transform:translateY(0) rotate(0);} 25%{transform:translateY(-14px) rotate(-6deg);} 50%{transform:translateY(10px) rotate(6deg);} 75%{transform:translateY(-6px) rotate(-3deg);} 100%{transform:translateY(0) rotate(0);} }

.center { display:flex; align-items:center; justify-content:center; }

.modal { position:fixed; inset:0; background:rgba(5,5,10,0.9); display:flex; align-items:center; justify-content:center; padding:20px; }
.modal .card { max-width:420px; width:100%; }

footer { margin-top:10px; color:var(--muted); font-size:12px; text-align:center; }

@media (max-width:420px){ :root{--card-w:200px; --card-h:300px;} body{padding:12px;} .logo{width:44px; height:44px;} }
</style>
</head>

<body>
<div class="app">
  <header>
    <div class="logo">ðŸŒ™</div>
    <div>
      <h1>Werwolf Karten</h1>
      <p class="lead">Mobile</p>
    </div>
  </header>

  <main>
    <!-- PREP CARD -->
    <section id="prepCard" class="card section">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:700">Vorbereitung</div>
      </div>

      <div style="margin-left:290px" class="row">
        <div class="small">Gesamt-Karten</div>
        <div id="totalCards" style="font-weight:700; margin-left:100px;">0</div>
      </div>

      <div class="roles-list" id="rolesList"></div>

      <div style="margin-top:15px" class="row">
        <input id="customRoleName" placeholder="Eigene Rolle (z. B. Spion)" type="text" />
        <input id="customRoleEmoji" placeholder="Emoji" type="text" style="width:84px" />
      </div>
      <div style="margin-top:8px" class="row">
        <button id="addCustomRoleBtn" class="btn-ghost">+ Rolle hinzufÃ¼gen</button>
      </div>

      <div style="margin-top:10px" class="row">
        <button id="toPlayersBtn" class="btn">Weiter zu Spielern</button>
        <button id="resetRolesBtn" class="btn-ghost">ZurÃ¼cksetzen</button>
      </div>
    </section>

    <!-- PLAYERS CARD -->
    <section id="playersCard" class="card section" style="display:none;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:700">Spieler</div>
        <div class="small">Gib Namen fÃ¼r jede Karte ein</div>
      </div>
      <div class="players-grid" id="playersGrid"></div>

      <div style="margin-top:10px" class="row">
        <button id="assignBtn" class="btn">Rollen zufÃ¤llig zuweisen & Spiel starten</button>
        <button id="backToPrepBtn" class="btn-ghost">Neue Runde</button>
      </div>
    </section>

    <!-- GAME CARD -->
    <section id="gameCard" class="card section" style="display:none;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:700">Karten verteilen</div>
        <div class="small" id="progressLabel">0 / 0</div>
      </div>
      <div class="game-area">
        <div id="deckWrap" class="deck center"></div>
        <div class="controls" style="width:100%">
          <div class="row">
            <button id="prevBtn" class="btn-ghost">ZurÃ¼ck</button>
            <button id="nextBtn" class="btn">NÃ¤chster Spieler</button>
          </div>
          <div class="row">
            <button id="revealBtn" class="btn-ghost">Karten erneut anzeigen</button>
            <button id="masterBtn" class="btn-ghost">Spielleiter-Ãœbersicht</button>
          </div>
          <div class="row">
            <button id="toPrepBtn" class="btn-ghost">Neue Runde</button>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
<div id="modalRoot"></div>

<script>
// --- Rollenverwaltung mit Plus/Minus Buttons ---
const roles = [];
const rolesList = document.getElementById("rolesList");
const totalCardsEl = document.getElementById("totalCards");

function renderRoles() {
  rolesList.innerHTML = "";
  let total = 0;
  roles.forEach((role, index) => {
    total += role.count;
    const row = document.createElement("div");
    row.className = "role-row";

    const icon = document.createElement("div");
    icon.className = "role-icon";
    icon.textContent = role.emoji || "ðŸŽ­";

    const name = document.createElement("div");
    name.className = "role-name";
    name.textContent = role.name;

    const controls = document.createElement("div");
    controls.className = "role-controls";

    const minus = document.createElement("button");
    minus.className = "count-btn";
    minus.textContent = "-";
    minus.onclick = () => {
      if (role.count > 0) role.count--;
      renderRoles();
    };

    const count = document.createElement("div");
    count.className = "role-count";
    count.textContent = role.count;

    const plus = document.createElement("button");
    plus.className = "count-btn";
    plus.textContent = "+";
    plus.onclick = () => {
      role.count++;
      renderRoles();
    };

    controls.appendChild(minus);
    controls.appendChild(count);
    controls.appendChild(plus);

    row.appendChild(icon);
    row.appendChild(name);
    row.appendChild(controls);
    rolesList.appendChild(row);
  });
  totalCardsEl.textContent = total;
}

document.getElementById("addCustomRoleBtn").onclick = () => {
  const name = document.getElementById("customRoleName").value.trim();
  const emoji = document.getElementById("customRoleEmoji").value.trim();
  if (!name) return;
  roles.push({ name, emoji, count: 1 });
  renderRoles();
  document.getElementById("customRoleName").value = "";
  document.getElementById("customRoleEmoji").value = "";
};

document.getElementById("resetRolesBtn").onclick = () => {
  roles.length = 0;
  renderRoles();
};

// --- Spielerverwaltung ---
const playersGrid = document.getElementById("playersGrid");
const prepCard = document.getElementById("prepCard");
const playersCard = document.getElementById("playersCard");
const gameCard = document.getElementById("gameCard");

document.getElementById("toPlayersBtn").onclick = () => {
  prepCard.style.display = "none";
  playersCard.style.display = "block";

  // Spielerinputs generieren
  playersGrid.innerHTML = "";
  roles.forEach(role => {
    for (let i = 0; i < role.count; i++) {
      const div = document.createElement("div");
      div.className = "player-input";
      const input = document.createElement("input");
      input.placeholder = "Spielername";
      div.appendChild(input);
      playersGrid.appendChild(div);
    }
  });
};

// --- Zuweisung der Rollen ---
document.getElementById("assignBtn").onclick = () => {
  const playerNames = Array.from(playersGrid.querySelectorAll("input")).map(i => i.value.trim() || "Spieler");
  let allRoles = [];
  roles.forEach(r => {
    for (let i = 0; i < r.count; i++) allRoles.push(r);
  });
  // Rollen mischen
  allRoles = allRoles.sort(() => Math.random() - 0.5);

  const deckWrap = document.getElementById("deckWrap");
  deckWrap.innerHTML = "";
  allRoles.forEach((r, idx) => {
    const card = document.createElement("div");
    card.className = "card-inner";

    const front = document.createElement("div");
    front.className = "face front";
    front.innerHTML = `<div class="role-emoji">${r.emoji||"ðŸŽ­"}</div><div class="role-label">${r.name}</div>`;

    const back = document.createElement("div");
    back.className = "face back";
    back.innerHTML = `<div class="player-name">${playerNames[idx]}</div>`;

    card.appendChild(front);
    card.appendChild(back);

    const wrapper = document.createElement("div");
    wrapper.className = "deck";
    wrapper.appendChild(card);
    deckWrap.appendChild(wrapper);

    wrapper.onclick = () => {
      card.parentElement.querySelectorAll(".card-inner").forEach(c => c.classList.remove("flipped"));
      card.classList.toggle("flipped");
    };
  });

  playersCard.style.display = "none";
  gameCard.style.display = "block";
  document.getElementById("progressLabel").textContent = `0 / ${allRoles.length}`;
};

</script>
</body>
</html>
